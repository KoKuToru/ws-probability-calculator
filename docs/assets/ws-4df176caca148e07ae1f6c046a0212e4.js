"use strict"
define("ws/app",["exports","@ember/application","ember-resolver","ember-load-initializers","ws/config/environment"],(function(e,t,r,n,o){function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e
var r=e[Symbol.toPrimitive]
if(void 0!==r){var n=r.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{constructor(...e){super(...e),i(this,"modulePrefix",o.default.modulePrefix),i(this,"podModulePrefix",o.default.podModulePrefix),i(this,"Resolver",r.default)}}e.default=s,(0,n.default)(s,o.default.modulePrefix)})),define("ws/component-managers/glimmer",["exports","@glimmer/component/-private/ember-component-manager"],(function(e,t){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.default}})})),define("ws/components/code-validation",["exports","@ember/component","@glimmer/component","@ember/template-factory"],(function(e,t,r,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,n.createTemplateFactory)({id:"3x5kwjUK",block:'[[[10,1],[12],[10,0],[15,0,[29,["indicator ",[30,0,["class"]]]]],[15,"title",[30,1,["error"]]],[12],[13],[1," "],[13],[1,"\\n"],[42,[28,[37,3],[[28,[37,3],[[30,1,["children"]]],null]],null],null,[[[8,[39,4],null,[["@value"],[[30,2]]],null]],[2]],null]],["@value","line"],false,["span","div","each","-track-array","code-validation"]]',moduleName:"ws/components/code-validation.hbs",isStrictMode:!1})
class i extends r.default{get class(){return this.args.value?.error?"bad":this.args.value?.code?"ok":"comment"}}e.default=i,(0,t.setComponentTemplate)(o,i)})),define("ws/components/code",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","ws/utils/code-parser","ws/utils/code-compressor","@glimmer/tracking","@tiptap/core","@tiptap/extension-document","@tiptap/extension-history","@tiptap/extension-paragraph","@tiptap/extension-text","@tiptap/extension-dropcursor","@tiptap/extension-gapcursor","ws/utils/tiptap/linter","ws/utils/tiptap/linter-ws-code","ws/utils/tiptap/fix-copy","ws/utils/tiptap/ide-tab","ws/utils/tiptap/ide-enter","@ember/template-factory"],(function(e,t,r,n,o,i,s,a,l,c,d,u,p,m,f,h,g,b,y,_,v){var x,w,O,j
function k(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function P(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function z(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r
throw new TypeError("Private element is not present on this object")}function $(e,t,r,n,o){var i={}
return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer?(Object.defineProperty(e,t,i),null):i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const M=(0,v.createTemplateFactory)({id:"eXzve0PP",block:'[[[1,[28,[35,0],[[30,0,["compressed"]]],null]],[1,"\\n"],[8,[39,1],null,[["@name"],["code_open"]],[["header","default"],[[[[1,"\\n    "],[10,1],[12],[1,"Code"],[13],[1,"\\n    "],[10,1],[15,"title",[30,0,["state","code"]]],[12],[1,[30,0,["compressed"]]],[13],[1,"\\n    "],[10,1],[14,0,"flex-grow"],[12],[13],[1,"\\n  "]],[]],[[[1,"\\n    "],[10,0],[14,0,"main"],[12],[1,"\\n      "],[11,0],[24,0,"code"],[4,[38,6],[[30,0,["setupEditor"]]],null],[4,[38,7],[[30,0,["updateEditor"]],[30,0,["state","code"]]],null],[4,[38,8],[[30,0,["destroyEditor"]]],null],[12],[1,"\\n        "],[10,0],[12],[42,[28,[37,10],[[28,[37,10],[[30,0,["codeParsed"]]],null]],null],null,[[[8,[39,11],null,[["@value"],[[30,1]]],null]],[1]],null],[13],[1,"\\n      "],[13],[1,"\\n"],[41,[30,0,["state","code_error"]],[[[1,"        "],[10,0],[14,0,"code-error"],[12],[1,[30,0,["state","code_error"]]],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n    "],[10,0],[14,0,"settings"],[12],[1,"\\n      "],[8,[39,1],null,[["@name"],["settings_open"]],[["header","default"],[[[[1,"\\n          "],[10,1],[12],[1,"Settings"],[13],[1,"\\n          "],[10,1],[14,0,"flex-grow"],[12],[13],[1,"\\n        "]],[]],[[[1,"\\n          "],[10,0],[12],[13],[10,0],[12],[1,"trg"],[13],[10,0],[12],[1,"ds"],[13],[1,"\\n\\n          "],[10,"label"],[12],[1,"my_deck"],[13],[1,"\\n          "],[11,"input"],[16,2,[30,0,["state","my_deck_trg"]]],[4,[38,15],["change",[28,[37,16],[[30,0,["change"]],"my_deck_trg"],null]],null],[12],[13],[1,"\\n          "],[11,"input"],[16,2,[30,0,["state","my_deck_ds"]]],[4,[38,15],["change",[28,[37,16],[[30,0,["change"]],"my_deck_ds"],null]],null],[12],[13],[1,"\\n          "],[10,"label"],[12],[1,"my_unused"],[13],[1,"\\n          "],[11,"input"],[16,2,[30,0,["state","my_unused_trg"]]],[4,[38,15],["change",[28,[37,16],[[30,0,["change"]],"my_unused_trg"],null]],null],[12],[13],[1,"\\n          "],[11,"input"],[16,2,[30,0,["state","my_unused_ds"]]],[4,[38,15],["change",[28,[37,16],[[30,0,["change"]],"my_unused_ds"],null]],null],[12],[13],[1,"\\n\\n          "],[10,"hr"],[12],[13],[1,"\\n\\n          "],[10,0],[12],[13],[10,0],[12],[1,"cx"],[13],[10,0],[12],[1,"ds"],[13],[1,"\\n          "],[10,"label"],[12],[1,"op_unused"],[13],[1,"\\n          "],[11,"input"],[16,2,[30,0,["state","op_unused_cx"]]],[4,[38,15],["change",[28,[37,16],[[30,0,["change"]],"op_unused_cx"],null]],null],[12],[13],[1,"\\n          "],[11,"input"],[16,2,[30,0,["state","op_unused_ds"]]],[4,[38,15],["change",[28,[37,16],[[30,0,["change"]],"op_unused_ds"],null]],null],[12],[13],[1,"\\n        "]],[]]]]],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]],[1,"\\n"]],["line"],false,["page-title","section",":header","span",":default","div","did-insert","did-update","will-destroy","each","-track-array","code-validation","if","label","input","on","fn","hr"]]',moduleName:"ws/components/code.hbs",isStrictMode:!1})
let C=e.default=(j=new WeakMap,x=class extends r.default{constructor(...e){super(...e),k(this,"state",w,this),P(this,j,void 0),k(this,"_editor",O,this)}store(){const e=[],t=(0,s.compress)(this.codeParsed,e),r=(0,s.decompress)(t,e)
this.state.code=(0,i.unparse)(r),this.state.store()}getCode(){let e=this.state.code??""
e=e.split("\n")
return{type:"doc",content:e.map((e=>({type:"paragraph",content:e.length?[{type:"text",text:e}]:void 0})))}}parseDoc(e){const t=[]
for(const r of e.content??[])if(r.content)for(const e of r.content)t.push(e.text??"")
else t.push("")
return t.join("\n")}updateCode({editor:e}){const t=this.parseDoc(e.getJSON())
var r,n,o
n=this,o=t,(r=j).set(z(r,n),o),this.state.code=t}get codeParsed(){return(0,i.default)(this.state.code)}get compressed(){return(0,s.compress)(this.codeParsed)}reset(e){e.stopPropagation(),confirm("reset?")&&this.state.reset_code()}setupEditor(e){const t=c.default.extend({content:"paragraph*"})
this._editor=new l.Editor({element:e,extensions:[t,u.default,p.default,m.default,f.default,d.default,h.default.configure({plugins:[g.default]}),b.default,y.default,_.default],content:this.getCode(),onUpdate:this.updateCode,onBlur:this.store,onCreate:({editor:e})=>{e.view.dom.setAttribute("spellcheck","false"),e.view.dom.setAttribute("autocomplete","off"),e.view.dom.setAttribute("autocapitalize","off")}})}destroyEditor(e){this._editor.destroy()}updateEditor(e){const t=this.state.code??""
var r,n;(n=this,(r=j).get(z(r,n))!==t)&&this._editor.commands.setContent(this.getCode())}change(e,t){let r=t.target.value
""===r.trim()?r=void 0:(r=r.trim(),r=parseInt(r),isNaN(r)&&(r=void 0)),t.target.setCustomValidity(""),this.state[e]=r,this.state.store()}},w=$(x.prototype,"state",[o.service],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$(x.prototype,"store",[n.action],Object.getOwnPropertyDescriptor(x.prototype,"store"),x.prototype),$(x.prototype,"getCode",[n.action],Object.getOwnPropertyDescriptor(x.prototype,"getCode"),x.prototype),$(x.prototype,"updateCode",[n.action],Object.getOwnPropertyDescriptor(x.prototype,"updateCode"),x.prototype),$(x.prototype,"codeParsed",[a.cached],Object.getOwnPropertyDescriptor(x.prototype,"codeParsed"),x.prototype),$(x.prototype,"compressed",[a.cached],Object.getOwnPropertyDescriptor(x.prototype,"compressed"),x.prototype),$(x.prototype,"reset",[n.action],Object.getOwnPropertyDescriptor(x.prototype,"reset"),x.prototype),O=$(x.prototype,"_editor",[a.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$(x.prototype,"setupEditor",[n.action],Object.getOwnPropertyDescriptor(x.prototype,"setupEditor"),x.prototype),$(x.prototype,"destroyEditor",[n.action],Object.getOwnPropertyDescriptor(x.prototype,"destroyEditor"),x.prototype),$(x.prototype,"updateEditor",[n.action],Object.getOwnPropertyDescriptor(x.prototype,"updateEditor"),x.prototype),$(x.prototype,"change",[n.action],Object.getOwnPropertyDescriptor(x.prototype,"change"),x.prototype),x);(0,t.setComponentTemplate)(M,C)})),define("ws/components/data-highlighter",["exports","@glimmer/component","@ember/destroyable","@ember/object"],(function(e,t,r,n){var o,i
function s(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function a(e,t){return e.get(function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r
throw new TypeError("Private element is not present on this object")}(e,t))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(i=new WeakMap,o=class extends t.default{constructor(...e){super(...e),s(this,i,document.createElement("style"))
const t=document.documentElement,n=document.head
t.addEventListener("mousemove",this.mousemove),n.append(a(i,this)),(0,r.registerDestructor)(this,(()=>{n.remove(a(i,this)),t.removeEventListener("mousemove",this.mousemove)}))}mousemove(e){const t=e.target.closest("[data-cx][data-ds], [data-cx], [data-ds], [data-dmg]")
if(!t)return void(a(i,this).textContent="")
const r=parseInt(t.dataset.cx),n=parseInt(t.dataset.ds),o=parseInt(t.dataset.dmg)
document.querySelector(`[data-cx="${r}"][data-ds="${n}"]`)?.scrollIntoViewIfNeeded?.(!0)
let s="__DUMMY__"
t.classList.contains("header")?(t.closest(".probability-section")?isNaN(r)||isNaN(n)||(s+=`,[data-cx="${r}"][data-ds="${n}"]::after`,s+=`,[data-cx="${r}"]:not([data-ds])::after`,s+=`,[data-ds="${n}"]:not([data-cx])::after`):(isNaN(r)||(s+=`,[data-cx="${r}"]::after`),isNaN(n)||(s+=`,[data-ds="${n}"]::after`)),isNaN(o)||(s+=`,[data-dmg="${o}"]::after`)):isNaN(r)||isNaN(n)?isNaN(r)?isNaN(n)?s+=`,[data-dmg="${o}"]::after`:s+=`,[data-ds="${n}"]::after`:s+=`,[data-cx="${r}"]::after`:(t.closest(".probability-section")?(s+=`,[data-cx="${r}"][data-ds="${n}"]:not([data-dmg])::after`,s+=`,[data-dmg="${o}"]:not([data-cx]):not([data-ds])::after`):s+=`,[data-cx="${r}"][data-ds="${n}"]::after`,s+=`,[data-cx="${r}"]:not([data-ds])::after`,s+=`,[data-ds="${n}"]:not([data-cx])::after`),s&&(s+="{\n  display: block;\n  content: '';\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  background: #b0c1d7;\n  mix-blend-mode: multiply;\n  pointer-events: none;\n}",a(i,this).textContent=s)}},l=o.prototype,c="mousemove",d=[n.action],u=Object.getOwnPropertyDescriptor(o.prototype,"mousemove"),p=o.prototype,m={},Object.keys(u).forEach((function(e){m[e]=u[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(l,c,e)||e}),m),p&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(p):void 0,m.initializer=void 0),void 0===m.initializer&&Object.defineProperty(l,c,m),o)
var l,c,d,u,p,m})),define("ws/components/overview",["exports","@ember/component","@glimmer/component","@ember/service","@ember/object","ws/components/probability","@glimmer/tracking","ws/utils/code-parser","ws/utils/code-execute","ws/utils/code-compressor","@ember/template-factory"],(function(e,t,r,n,o,i,s,a,l,c,d){var u,p,m,f,h,g
function b(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function y(e,t,r){_(e,t),t.set(e,r)}function _(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function v(e,t,r){return e.set(w(e,t),r),r}function x(e,t){return e.get(w(e,t))}function w(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r
throw new TypeError("Private element is not present on this object")}function O(e,t,r,n,o){var i={}
return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer?(Object.defineProperty(e,t,i),null):i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const j=(0,d.createTemplateFactory)({id:"3B3OrZeZ",block:'[[[8,[39,0],null,[["@name"],["overview_open"]],[["header","default"],[[[[1,"\\n    "],[10,1],[12],[1,"Overview"],[13],[1,"\\n    "],[10,1],[12],[1,[30,0,["overview_extra"]]],[13],[1,"\\n    "],[10,1],[14,0,"flex-grow"],[12],[13],[1,"\\n"],[1,"  "]],[]],[[[1,"\\n    "],[11,0],[24,0,"table"],[4,[38,5],[[30,0,["setWidth"]],[30,0,["data"]]],null],[4,[38,6],[[30,0,["setWidth"]],[30,0,["data"]]],null],[4,[38,5],[[30,0,["calculate"]],[30,0,["state","code"]],[30,0,["state","overview_open"]]],null],[4,[38,6],[[30,0,["calculate"]],[30,0,["state","code"]],[30,0,["state","overview_open"]]],null],[4,[38,6],[[30,0,["forceCalculate"]],[30,0,["state","result"]],[30,0,["state","my_deck_trg"]],[30,0,["state","my_deck_ds"]],[30,0,["state","my_unused_trg"]],[30,0,["state","my_unused_ds"]],[30,0,["state","op_unused_cx"]],[30,0,["state","op_unused_ds"]]],null],[4,[38,5],[[30,0,["scrollIntoView"]]],null],[12],[1,"\\n"],[42,[28,[37,8],[[28,[37,8],[[30,0,["data"]]],null]],null],null,[[[41,[30,1,["corner"]],[[[1,"          "],[10,0],[15,0,[30,1,["class"]]],[12],[1,"\\n            "],[10,1],[12],[1,"ds"],[13],[1,"\\n            "],[10,1],[12],[1,"cx"],[13],[1,"\\n            "],[10,"svg"],[14,"viewBox","0 0 1 1"],[14,"preserveAspectRatio","none"],[12],[1,"\\n              "],[10,"line"],[14,"x1","0"],[14,"y1","0"],[14,"x2","1"],[14,"y2","1"],[14,"stroke","black"],[14,"vector-effect","non-scaling-stroke"],[12],[13],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[41,[30,1,["header"]],[[[1,"          "],[11,0],[16,0,[30,1,["class"]]],[16,"data-cx",[30,1,["x"]]],[16,"data-ds",[30,1,["y"]]],[24,"tabindex","0"],[4,[38,12],["click",[28,[37,13],[[30,0,["toggleHeader"]],[30,1]],null]],null],[12],[1,"\\n            "],[1,[30,1,["value"]]],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[41,[28,[30,0,["getAnyValue"]],[[30,1,["value"]]],null],[[[44,[[28,[30,0,["getCellValue"]],[[30,1,["value"]]],null]],[[[44,[[28,[30,0,["getCellClass"]],[[30,1,["value"]]],null]],[[[1,"                "],[11,0],[16,0,[30,3]],[16,"data-cx",[30,1,["x"]]],[16,"data-ds",[30,1,["y"]]],[24,"tabindex","0"],[4,[38,12],["click",[28,[37,13],[[30,0,["toggleCell"]],[30,1,["value"]]],null]],null],[12],[1,"\\n"],[41,[30,2],[[[1,"                    "],[1,[28,[35,15],[[30,2]],null]],[1,"\\n"]],[]],[[[1,"                    "],[10,"svg"],[14,"viewBox","0 0 1 1"],[14,"preserveAspectRatio","none"],[12],[1,"\\n                      "],[10,"line"],[14,"x1","0"],[14,"y1","1"],[14,"x2","1"],[14,"y2","0"],[14,"stroke","lightgray"],[14,"vector-effect","non-scaling-stroke"],[12],[13],[1,"\\n                    "],[13],[1,"\\n"]],[]]],[1,"                "],[13],[1,"\\n"]],[3]]]],[2]]]],[]],[[[1,"            "],[10,0],[15,"data-cx",[30,1,["x"]]],[15,"data-ds",[30,1,["y"]]],[12],[1,"\\n              "],[10,"svg"],[14,"viewBox","0 0 1 1"],[14,"preserveAspectRatio","none"],[12],[1,"\\n                "],[10,"line"],[14,"x1","0"],[14,"y1","1"],[14,"x2","1"],[14,"y2","0"],[14,"stroke","lightgray"],[14,"vector-effect","non-scaling-stroke"],[12],[13],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n"]],[]]],[1,"        "]],[]]]],[]]]],[1]],null],[1,"    "],[13],[1,"\\n  "]],[]]]]]],["x","value","class"],false,["section",":header","span",":default","div","did-insert","did-update","each","-track-array","if","svg","line","on","fn","let","format-number"]]',moduleName:"ws/components/overview.hbs",isStrictMode:!1})
let k=e.default=(f=new WeakSet,h=new WeakMap,g=new WeakMap,u=class extends r.default{constructor(...e){var t,r
super(...e),_(t=this,r=f),r.add(t),b(this,"state",p,this),b(this,"max_mean",m,this),y(this,h,""),y(this,g,new AbortController)}setWidth(e,[t]){e.style.setProperty("--columns",t.reduce(((e,t)=>e+(t.column??0)),0))}get codeParsed(){return(0,a.default)(this.state.code)}get compressed(){return(0,c.compress)(this.codeParsed)}get data(){const e=[]
e.push({header:!0,column:!0,corner:!0,class:"header col row corner"})
const t=Array(9).fill(null).map(((e,t)=>t))
for(const r of t)e.push({header:!0,column:!0,class:"header col selectable",x:r,value:r})
for(const r of Array(50).fill(null).map(((e,t)=>t+1))){e.push({class:"header row selectable",y:r,header:!0,value:r})
for(const n of t)e.push({x:n,y:r,value:[n,r]})}return e}getAnyValue(e){return e=this.state.result.get(...e),Boolean(e)}getCellClass(e){if(!(e=this.state.result.get(...e)))return
if(e.error){const t=["selectable"]
return this.state.isSelected([e.x,e.y].join())&&t.push("selected"),"invalid"===e.error?t.push("invalid"):t.push("error"),t.join(" ")}let t=null
const r=this.state.selected_dmg??null
let n=e.mean
null===r?t=Math.min(Math.floor(n*i.COLORS.length/this.max_mean),i.COLORS.length-1):0==r?(n=e.dmg[0],t=Math.min(Math.floor((1-n)*i.COLORS.length),i.COLORS.length-1)):(n=e.dmg.slice(r).reduce(((e,t)=>e+t),0),t=Math.min(Math.floor(n*i.COLORS.length),i.COLORS.length-1))
const o=["selectable"]
return n&&o.push(`color-${t}`),this.state.isSelected([e.x,e.y].join())&&o.push("selected"),o.join(" ")}getCellValue(e){if(!(e=this.state.result.get(...e)))return
if(e.error)return"invalid"==e.error?"INV":"ERR"
const t=this.state.selected_dmg??null
return null===t?e.mean:100*e.dmg_acc[t]}toggleCell(e){this.state.toggleSelected(e.join()),this.state.store()}toggleHeader(e){if("x"in e){let t=!0
for(let r=e.x;r<=50;++r)if(!this.state.isSelected([e.x,r].join())){t=!1
break}for(let r=e.x;r<=50;++r)t?this.state.toggleSelected([e.x,r].join()):this.state.isSelected([e.x,r].join())||this.state.toggleSelected([e.x,r].join())}if("y"in e){let t=!0
for(let r=0;r<=Math.min(8,e.y);++r)if(!this.state.isSelected([r,e.y].join())){t=!1
break}for(let r=0;r<=Math.min(8,e.y);++r)t?this.state.toggleSelected([r,e.y].join()):this.state.isSelected([r,e.y].join())||this.state.toggleSelected([r,e.y].join())}this.state.store()}async calculate(e){const t=this.state.overview_open+this.compressed
if(t===x(h,this))return
v(h,this,t),x(g,this).abort(),this.state.result.clear(),this.max_mean=i.COLORS.length,v(g,this,new AbortController)
const r=w(f,this,P).call(this,this.codeParsed),n=x(g,this).signal,o=parseInt(this.state.my_deck_trg),s=parseInt(this.state.my_deck_ds),a=parseInt(this.state.my_unused_trg),c=parseInt(this.state.my_unused_ds),d=parseInt(this.state.op_unused_cx),u=parseInt(this.state.op_unused_ds)
if(this.state.code_error="",o<0||o>15)return void(this.state.code_error="my_deck trg must be 0-15")
if(s<0||s>50)return void(this.state.code_error="my_deck ds must be 0-50")
if(a<0||a>15)return void(this.state.code_error="my_unused trg must be 0-15")
if(c<0||c>50)return void(this.state.code_error="my_unused ds must be 0-50")
if(o>s)return void(this.state.code_error="my_deck trg must be 0-ds")
if(a>c)return void(this.state.code_error="my_unused trg must be 0-ds")
if(o+a>15)return void(this.state.code_error="my_deck + my_unused trg must be 0-15")
if(s+c>50)return void(this.state.code_error="my_deck + my_unused ds must be 0-50")
if(d<0||d>8)return void(this.state.code_error="op_unused cx must be 0-15")
if(u<0||u>50)return void(this.state.code_error="op_unused ds must be 0-50")
if(d>u)return void(this.state.code_error="op_unused cx must be 0-ds")
let p=[]
const m=new Set([...this.state.selected])
for(const i of m){const[e,t]=i.split(",").map((e=>parseInt(e)))
p.push({cx:e,ds:t})}if(this.state.overview_open)for(let i=1;i<=50;++i)for(let e=0;e<=8;++e)m.has([e,i].join())||p.push({cx:e,ds:i})
p=p.filter((e=>e.cx<=e.ds&&50-(8-e.cx)>=e.ds)),p.forEach((e=>{const t=e.cx,n=e.ds,i=Math.max(-100,8-t-d),l=Math.max(-100,50-n-u),p=Math.max(-100,15-o-a),m=Math.max(-100,50-s-c)
Object.assign(e,{my_trg:o,my_size:s,my_w_trg:p,my_w_size:m,my_u_trg:a,my_u_size:c,op_cx:t,op_size:n,op_w_cx:i,op_w_size:l,op_u_cx:d,op_u_size:u,code:r})})),p=p.filter((e=>{const t=[Math.min(e.op_cx,e.op_w_cx,e.op_size,e.op_w_size,e.op_u_cx,e.op_u_size)>=0,e.op_cx<=e.op_size,e.op_w_cx<=e.op_w_size,e.op_u_cx<=e.op_u_size,e.op_cx+e.op_w_cx+e.op_u_cx==8,e.op_size+e.op_w_size+e.op_u_size==50,Math.min(e.my_trg,e.my_w_trg,e.my_size,e.my_w_size,e.my_u_trg,e.my_u_size)>=0,e.my_trg<=e.my_size,e.my_w_trg<=e.my_w_size,e.my_u_trg<=e.my_u_size,e.my_trg+e.my_w_trg+e.my_u_trg==15,e.my_size+e.my_w_size+e.my_u_size==50]
return e.valid=!t.some((e=>!e)),e.valid||this.state.result.set(e.cx,e.ds,{x:e.cx,y:e.ds,data:e,error:"invalid"}),e.valid}))
let b=!0,y=null
for await(const i of(0,l.default)(p,n)){n.throwIfAborted()
const e=i.data.op_cx,t=i.data.op_size
if(i.mean>this.max_mean&&(this.max_mean=i.mean),i.x=e,i.y=t,Object.freeze(i),this.state.result.set(e,t,i),b){b=!1
let e=[],t=[]
for(let[r,n]of i.code){e.length||e.push([]),"check"===r&&(n=[...n],n[0]=`stack[${n[0]}]`)
const o=`e.${r}(${(n??[]).join(", ")}); `
t[e.at(-1).length]=Math.max(t[e.at(-1).length]??0,o.length),e.at(-1).push(o),"flush"===r&&e.push([])}e.forEach((e=>{e.forEach(((r,n)=>{e[n]=r.padEnd(t[n]," ")}))})),this.state.debug_code=e.map((e=>e.join(""))).join("\n")}!y&&i.error&&(y=i.error)}this.state.code_error=y}forceCalculate(e){v(h,this,""),this.calculate(e,[this.state.code])}get overview_extra(){const e=this.state.selected_dmg??null
return null===e?"weighted average damage":0===e?"dmg 0 probability %":`dmg ≥ ${e} probability %`}reset(e){e.stopPropagation(),confirm("reset?")&&this.state.reset_overview()}scrollIntoView(e){if(!this.state.selected.length)return
const t=this.state.selected.reduce(((e,t)=>Math.min(e,parseInt(t.split(",")[0]))),8),r=this.state.selected.reduce(((e,t)=>Math.min(e,parseInt(t.split(",")[1]))),50)
e.querySelector(`[data-cx="${t}"][data-ds="${r}"]`)?.scrollIntoView?.()}},p=O(u.prototype,"state",[n.service],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=O(u.prototype,"max_mean",[s.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return i.COLORS.length}}),O(u.prototype,"getAnyValue",[o.action],Object.getOwnPropertyDescriptor(u.prototype,"getAnyValue"),u.prototype),O(u.prototype,"getCellClass",[o.action],Object.getOwnPropertyDescriptor(u.prototype,"getCellClass"),u.prototype),O(u.prototype,"getCellValue",[o.action],Object.getOwnPropertyDescriptor(u.prototype,"getCellValue"),u.prototype),O(u.prototype,"toggleCell",[o.action],Object.getOwnPropertyDescriptor(u.prototype,"toggleCell"),u.prototype),O(u.prototype,"toggleHeader",[o.action],Object.getOwnPropertyDescriptor(u.prototype,"toggleHeader"),u.prototype),O(u.prototype,"calculate",[o.action],Object.getOwnPropertyDescriptor(u.prototype,"calculate"),u.prototype),O(u.prototype,"forceCalculate",[o.action],Object.getOwnPropertyDescriptor(u.prototype,"forceCalculate"),u.prototype),O(u.prototype,"reset",[o.action],Object.getOwnPropertyDescriptor(u.prototype,"reset"),u.prototype),O(u.prototype,"scrollIntoView",[o.action],Object.getOwnPropertyDescriptor(u.prototype,"scrollIntoView"),u.prototype),u)
function P(e){return e.filter((e=>e.code)).map((e=>[...e.code,w(f,this,P).call(this,e.children)]))}(0,t.setComponentTemplate)(j,k)})),define("ws/components/probability",["exports","@ember/component","@glimmer/component","ws/helpers/format-number","@ember/service","@ember/object","@ember/template-factory"],(function(e,t,r,n,o,i,s){var a,l
function c(e,t,r,n,o){var i={}
return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer?(Object.defineProperty(e,t,i),null):i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.COLORS=void 0
const d=(0,s.createTemplateFactory)({id:"dDa8v4b1",block:'[[[8,[39,0],null,[["@name"],["probability_open"]],[["header","default"],[[[[1,"\\n    "],[10,1],[12],[1,"Probabilites"],[13],[1,"\\n    "],[10,1],[12],[1,"%"],[13],[1,"\\n    "],[10,1],[14,0,"flex-grow"],[12],[13],[1,"\\n"],[1,"  "]],[]],[[[1,"\\n"],[41,[30,0,["state","hasSelected"]],[[[1,"      "],[11,0],[24,0,"table"],[4,[38,6],[[30,0,["setWidth"]],[30,0,["cols"]]],null],[4,[38,7],[[30,0,["setWidth"]],[30,0,["cols"]]],null],[12],[1,"\\n        "],[10,0],[14,0,"header col row corner"],[12],[1,"\\n          "],[10,1],[12],[1,"cx / ds"],[13],[1,"\\n          "],[10,1],[12],[1,"dmg"],[13],[1,"\\n          "],[10,"svg"],[14,"viewBox","0 0 1 1"],[14,"preserveAspectRatio","none"],[12],[1,"\\n              "],[10,"line"],[14,"x1","0"],[14,"y1","0"],[14,"x2","1"],[14,"y2","1"],[14,"stroke","black"],[14,"vector-effect","non-scaling-stroke"],[12],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"],[42,[28,[37,11],[[28,[37,11],[[30,0,["cols"]]],null]],null],"@index",[[[1,"          "],[11,0],[16,0,[29,["header col selectable ",[52,[28,[30,0,["isSelectedDmg"]],[[30,1]],null],"selected"]]]],[16,"data-dmg",[30,1]],[4,[38,12],["click",[28,[37,13],[[30,0,["setDmg"]],[30,1]],null]],null],[12],[1,"\\n"],[41,[30,1],[[[1,"              ≥ "],[1,[30,1]],[1,"\\n"]],[]],[[[1,"              "],[1,[30,1]],[1,"\\n"]],[]]],[1,"          "],[13],[1,"\\n"]],[1]],null],[1,"\\n\\n"],[42,[28,[37,11],[[28,[37,11],[[30,0,["rows"]]],null]],null],null,[[[1,"          "],[10,0],[14,0,"header row"],[15,"data-cx",[28,[37,14],[[30,2],"0"],null]],[15,"data-ds",[28,[37,14],[[30,2],"1"],null]],[15,"title",[28,[30,0,["getTitle"]],[[30,2]],null]],[12],[1,"\\n            "],[1,[28,[35,14],[[30,2],"0"],null]],[1," / "],[1,[28,[35,14],[[30,2],"1"],null]],[1,"\\n          "],[13],[1,"\\n"],[42,[28,[37,11],[[28,[37,11],[[30,0,["cols"]]],null]],null],"@index",[[[44,[[28,[30,0,["getCellValue"]],[[30,2],[30,3]],null]],[[[44,[[28,[30,0,["getCellClass"]],[[30,4],[30,3]],null]],[[[41,[30,5],[[[1,"                  "],[10,0],[15,0,[30,5]],[15,"data-cx",[28,[37,14],[[30,2],"0"],null]],[15,"data-ds",[28,[37,14],[[30,2],"1"],null]],[15,"data-dmg",[30,3]],[12],[1,"\\n                    "],[1,[28,[35,16],[[30,4],5],null]],[1,"\\n                  "],[13],[1,"\\n"]],[]],[[[1,"                  "],[10,0],[12],[1,"\\n                    "],[10,"svg"],[14,"viewBox","0 0 1 1"],[14,"preserveAspectRatio","none"],[12],[1,"\\n                      "],[10,"line"],[14,"x1","0"],[14,"y1","1"],[14,"x2","1"],[14,"y2","0"],[14,"stroke","lightgray"],[14,"vector-effect","non-scaling-stroke"],[12],[13],[1,"\\n                    "],[13],[1,"\\n                  "],[13],[1,"\\n"]],[]]]],[5]]]],[4]]]],[3]],null]],[2]],null],[1,"      "],[13],[1,"\\n"]],[]],[[[1,"      "],[10,0],[14,0,"nothing-selected"],[12],[1,"\\n        nothing selected in overview\\n      "],[13],[1,"\\n"]],[]]],[1,"  "]],[]]]]]],["col","row","col","value","class"],false,["section",":header","span",":default","if","div","did-insert","did-update","svg","line","each","-track-array","on","fn","get","let","format-number"]]',moduleName:"ws/components/probability.hbs",isStrictMode:!1}),u=e.COLORS=["#e1645dDF","#f79172DF","#fdc388DF","#ffe8a8DF","#ffffcfDF","#e2f3a8DF","#bde290DF","#8dcd8aDF","#54b27cDF"]
{const e=document.createElement("style")
e.textContent=u.map(((e,t)=>`.color-${t} { background-color: ${e} !important; }\n`)).join(""),document.head.append(e)}let p=e.default=(a=class extends r.default{constructor(...e){var t,r,n,o
super(...e),t=this,r="state",o=this,(n=l)&&Object.defineProperty(t,r,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(o):void 0})}setWidth(e,[t]){e.style.setProperty("--columns",t.length+1)}get rows(){return this.state.selected.map((e=>e.split(",").map((e=>parseInt(e))))).sort(((e,t)=>{for(let r=0;r<Math.max(e.length,t.length);++r){if(e[r]<t[r])return 1
if(e[r]>t[r])return-1}return 0}))}get cols(){return Array(this.rows.reduce(((e,t)=>Math.max(e,this.state.result.get(...t)?.dmg?.length??0)),1)).fill().map(((e,t)=>t))}setDmg(e,t){this.state.selected_dmg===e?this.state.selected_dmg=null:this.state.selected_dmg=e,this.state.store()}isSelectedDmg(e){return this.state.selected_dmg===e}getTitle(e){const t=this.state.result.get(...e)
if(t){function r(e,...t){const r=[]
for(let n=0,o=0;n<e.length;++n)0!=n&&r.push(`${t[o++]}`.padStart(2,"0")),r.push(e[n])
return r.join("")}return[t.data.valid?null:"INVALID!!\n",r`my_deck\n\ttrg ${t.data.my_trg} / ${t.data.my_size} ds`,r`my_waitingroom\n\ttrg ${t.data.my_w_trg} / ${t.data.my_w_size} ds`,r`my_unused\n\ttrg ${t.data.my_u_trg} / ${t.data.my_u_size} ds`,r``,r`op_deck\n\tcx ${t.data.op_cx} / ${t.data.op_size} ds`,r`op_waitingroom\n\tcx ${t.data.op_w_cx} / ${t.data.op_w_size} ds`,r`op_unused\n\tcx ${t.data.op_u_cx} / ${t.data.op_u_size} ds`].filter((e=>e)).join("\n")}}getCellValue(e,t){const r=this.state.result.get(...e)
if(!r)return null
if(r.error)return"invalid"===r.error?"INV":"ERR"
let n=r.dmg_acc[t]
return n?100*n:null}getCellClass(e,t){if(e??=null,null===e)return null
if("INV"===e)return"invalid"
if("ERR"===e)return"error"
let r
return r=0==t?Math.min(Math.floor((100-e)*u.length/100),u.length-1):Math.min(Math.floor(e*u.length/100),u.length-1),`color-${r}`}reset(e){e.stopPropagation(),confirm("reset?")&&this.state.reset_probability()}},l=c(a.prototype,"state",[o.service],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c(a.prototype,"setDmg",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"setDmg"),a.prototype),c(a.prototype,"isSelectedDmg",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"isSelectedDmg"),a.prototype),c(a.prototype,"getTitle",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"getTitle"),a.prototype),c(a.prototype,"getCellValue",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"getCellValue"),a.prototype),c(a.prototype,"getCellClass",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"getCellClass"),a.prototype),c(a.prototype,"reset",[i.action],Object.getOwnPropertyDescriptor(a.prototype,"reset"),a.prototype),a);(0,t.setComponentTemplate)(d,p)})),define("ws/components/section",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","@ember/template-factory"],(function(e,t,r,n,o,i){var s,a
function l(e,t,r,n,o){var i={}
return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer?(Object.defineProperty(e,t,i),null):i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=(0,i.createTemplateFactory)({id:"nuRGYv1K",block:'[[[11,0],[24,0,"section"],[16,"data-open",[30,0,["open"]]],[17,1],[12],[1,"\\n  "],[11,"summary"],[24,"tabindex","0"],[4,[38,2],["click",[30,0,["toggle"]]],null],[12],[18,2,null],[13],[1,"\\n  "],[10,0],[12],[1,"\\n    "],[18,3,null],[1,"\\n  "],[13],[1,"\\n"],[13]],["&attrs","&header","&default"],false,["div","summary","on","yield"]]',moduleName:"ws/components/section.hbs",isStrictMode:!1})
let d=e.default=(s=class extends r.default{constructor(...e){var t,r,n,o
super(...e),t=this,r="state",o=this,(n=a)&&Object.defineProperty(t,r,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(o):void 0})}get open(){return this.state[this.args.name]??this.args.open??!0}toggle(e){this.state[this.args.name]=!this.open,this.state.store()}},a=l(s.prototype,"state",[o.service],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l(s.prototype,"toggle",[n.action],Object.getOwnPropertyDescriptor(s.prototype,"toggle"),s.prototype),s);(0,t.setComponentTemplate)(c,d)})),define("ws/components/shell",["exports","@ember/component","@glimmer/component","@ember/service","@ember/object","@ember/template-factory"],(function(e,t,r,n,o,i){var s,a
function l(e,t,r,n,o){var i={}
return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer?(Object.defineProperty(e,t,i),null):i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=(0,i.createTemplateFactory)({id:"ZzM2/MEA",block:'[[[41,[30,0,["state","loaded"]],[[[1,"  "],[10,0],[14,0,"header-section"],[12],[1,"\\n    "],[10,"summary"],[12],[1,"\\n      "],[10,1],[12],[1,"Weiß Schwarz"],[13],[1,"\\n      "],[10,1],[12],[1,"Probability Calculator BETA"],[13],[1,"\\n      "],[10,1],[14,0,"flex-grow"],[12],[13],[1,"\\n"],[41,[30,0,["canShare"]],[[[1,"        "],[10,1],[12],[11,"button"],[4,[38,5],["click",[30,0,["share"]]],null],[12],[1,"share"],[13],[13],[1,"\\n"]],[]],null],[1,"      "],[10,1],[12],[11,"button"],[4,[38,5],["click",[30,0,["help"]]],null],[12],[1,"help"],[13],[13],[1,"\\n      "],[10,1],[12],[11,"button"],[4,[38,5],["click",[30,0,["reset"]]],null],[12],[1,"reset"],[13],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n  "],[10,0],[14,0,"code-section"],[12],[1,"\\n    "],[8,[39,6],null,null,null],[1,"\\n  "],[13],[1,"\\n  "],[10,0],[14,0,"code-section"],[12],[1,"\\n    "],[8,[39,7],null,[["@name"],["debug_open"]],[["header","default"],[[[[1,"\\n        "],[10,1],[12],[1,"Executed Code"],[13],[1,"\\n      "]],[]],[[[1,"\\n        "],[10,0],[14,0,"code code-compiled"],[12],[1,"\\n          "],[10,"code"],[12],[1,[30,0,["state","debug_code"]]],[13],[1,"\\n        "],[13],[1,"\\n      "]],[]]]]],[1,"\\n  "],[13],[1,"\\n  "],[10,0],[14,0,"overview-section"],[12],[1,"\\n    "],[8,[39,10],null,null,null],[1,"\\n  "],[13],[1,"\\n  "],[10,0],[14,0,"probability-section"],[12],[1,"\\n    "],[8,[39,11],null,null,null],[1,"\\n  "],[13],[1,"\\n"]],[]],[[[1,"  Loading..\\n"]],[]]]],[],false,["if","div","summary","span","button","on","code","section",":header",":default","overview","probability"]]',moduleName:"ws/components/shell.hbs",isStrictMode:!1})
let d=e.default=(s=class extends r.default{constructor(...e){var t,r,n,o
super(...e),t=this,r="state",o=this,(n=a)&&Object.defineProperty(t,r,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(o):void 0})}help(e){e.stopPropagation(),window.open("https://github.com/KoKuToru/ws-probability-calculator/blob/gh-pages/README.md","_blank")}reset(e){e.stopPropagation(),confirm("reset everything?")&&this.state.reset()}get canShare(){return navigator.share&&navigator.canShare}share(e){e.stopPropagation(),navigator.share({url:document.URL,title:document.title})}},a=l(s.prototype,"state",[n.service],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l(s.prototype,"help",[o.action],Object.getOwnPropertyDescriptor(s.prototype,"help"),s.prototype),l(s.prototype,"reset",[o.action],Object.getOwnPropertyDescriptor(s.prototype,"reset"),s.prototype),l(s.prototype,"share",[o.action],Object.getOwnPropertyDescriptor(s.prototype,"share"),s.prototype),s);(0,t.setComponentTemplate)(c,d)})),define("ws/container-debug-adapter",["exports","ember-resolver/container-debug-adapter"],(function(e,t){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.default}})})),define("ws/helpers/app-version",["exports","@ember/component/helper","ws/config/environment","ember-cli-app-version/utils/regexp"],(function(e,t,r,n){function o(e,t={}){const o=r.default.APP.version
let i=t.versionOnly||t.hideSha,s=t.shaOnly||t.hideVersion,a=null
return i&&(t.showExtended&&(a=o.match(n.versionExtendedRegExp)),a||(a=o.match(n.versionRegExp))),s&&(a=o.match(n.shaRegExp)),a?a[0]:o}Object.defineProperty(e,"__esModule",{value:!0}),e.appVersion=o,e.default=void 0
e.default=(0,t.helper)(o)})),define("ws/helpers/format-number",["exports","@ember/component/helper"],(function(e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.formatNumber=n
const r=[]
function n(e,t){for(t??=4;r.length<t+2;)r.unshift(new Intl.NumberFormat("en-US",{maximumFractionDigits:r.length,minimumFractionDigits:r.length}))
if(isNaN(e))return""
for(let n of r){const o=n.format(e)
if(o.length<=t||n===r.at(-1))return o}throw new Error("UNREACHABLE")}e.default=(0,t.helper)((function(e){return n(...e)}))})),define("ws/helpers/page-title",["exports","ember-page-title/helpers/page-title"],(function(e,t){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.default}})})),define("ws/initializers/app-version",["exports","ember-cli-app-version/initializer-factory","ws/config/environment"],(function(e,t,r){let n,o
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,r.default.APP&&(n=r.default.APP.name,o=r.default.APP.version)
e.default={name:"App Version",initialize:(0,t.default)(n,o)}})),define("ws/modifiers/did-insert",["exports","@ember/render-modifiers/modifiers/did-insert"],(function(e,t){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.default}})})),define("ws/modifiers/did-update",["exports","@ember/render-modifiers/modifiers/did-update"],(function(e,t){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.default}})})),define("ws/modifiers/will-destroy",["exports","@ember/render-modifiers/modifiers/will-destroy"],(function(e,t){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.default}})})),define("ws/router",["exports","@ember/routing/router","ws/config/environment"],(function(e,t,r){function n(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e
var r=e[Symbol.toPrimitive]
if(void 0!==r){var n=r.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{constructor(...e){super(...e),n(this,"location",r.default.locationType),n(this,"rootURL",r.default.rootURL)}}e.default=o,o.map((function(){}))})),define("ws/services/codec",["exports"],(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default="*-.0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz"})),define("ws/services/page-title",["exports","ember-page-title/services/page-title"],(function(e,t){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.default}})})),define("ws/services/state",["exports","@ember/service","@ember/destroyable","@glimmer/tracking","@ember/object","ws/utils/result-map","ws/services/codec","ws/utils/code-parser","ws/utils/code-compressor"],(function(e,t,r,n,o,i,s,a,l){var c,d,u,p,m,f,h,g,b,y,_,v,x,w,O,j,k,P,z,$,M
function C(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function E(e,t){return e.get(function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r
throw new TypeError("Private element is not present on this object")}(e,t))}function S(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function D(e,t,r,n,o){var i={}
return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer?(Object.defineProperty(e,t,i),null):i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let T=(d=D((c=class{constructor(){S(this,"loaded",d,this),S(this,"code",u,this),S(this,"code_error",p,this),S(this,"selected",m,this),S(this,"result",f,this),S(this,"code_open",h,this),S(this,"overview_open",g,this),S(this,"probability_open",b,this),S(this,"settings_open",y,this),S(this,"selected_dmg",_,this),S(this,"my_deck_trg",v,this),S(this,"my_deck_ds",x,this),S(this,"my_unused_trg",w,this),S(this,"my_unused_ds",O,this),S(this,"op_unused_cx",j,this),S(this,"op_unused_ds",k,this)}}).prototype,"loaded",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=D(c.prototype,"code",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=D(c.prototype,"code_error",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=D(c.prototype,"selected",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set(["8,30","8,25","8,20","6,30","6,25","6,20"])}}),f=D(c.prototype,"result",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new i.default(10,51)}}),h=D(c.prototype,"code_open",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),g=D(c.prototype,"overview_open",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),b=D(c.prototype,"probability_open",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),y=D(c.prototype,"settings_open",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),_=D(c.prototype,"selected_dmg",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=D(c.prototype,"my_deck_trg",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=D(c.prototype,"my_deck_ds",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=D(c.prototype,"my_unused_trg",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=D(c.prototype,"my_unused_ds",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=D(c.prototype,"op_unused_cx",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=D(c.prototype,"op_unused_ds",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c)
e.default=(M=new WeakMap,P=class extends t.default{reset(){const e=new T
for(const t of["selected_dmg","probability_open","overview_open","code_open","selected","code","result","my_deck_trg","my_deck_ds","my_unused_trg","my_unused_ds","op_unused_cx","op_unused_ds"])E(M,this)[t]=e[t]
this.store()}reset_code(){const e=new T
for(const t of["code","result"])E(M,this)[t]=e[t]
this.store()}reset_overview(){const e=new T
for(const t of["selected","selected_dmg"])E(M,this)[t]=e[t]
this.store()}reset_probability(){const e=new T
for(const t of["selected","selected_dmg"])E(M,this)[t]=e[t]
this.store()}get my_deck_trg(){return E(M,this).my_deck_trg??15}set my_deck_trg(e){E(M,this).my_deck_trg=e}get my_deck_ds(){return E(M,this).my_deck_ds??50}set my_deck_ds(e){E(M,this).my_deck_ds=e}get my_unused_trg(){return E(M,this).my_unused_trg??0}set my_unused_trg(e){E(M,this).my_unused_trg=e}get my_unused_ds(){return E(M,this).my_unused_ds??0}set my_unused_ds(e){E(M,this).my_unused_ds=e}get op_unused_cx(){return E(M,this).op_unused_cx??0}set op_unused_cx(e){E(M,this).op_unused_cx=e}get op_unused_ds(){return E(M,this).op_unused_ds??0}set op_unused_ds(e){E(M,this).op_unused_ds=e}get loaded(){return E(M,this).loaded}get code(){return E(M,this).code??"# demo script with fictional card effects..\n# see help for real examples\n\nprocedure a3cb1\n  attack 3\n    if cx\n      burn 1\n\nrepeat 2\n  execute a3cb1\n\nmill 3\n  each cx\n    burn 2\n  else\n    attack 3\n      if trg\n        damage 1\n"}set code(e){E(M,this).code=e}get code_error(){return E(M,this).code_error}set code_error(e){E(M,this).code_error=e}get result(){return E(M,this).result}set result(e){E(M,this).result=e}get code_open(){return E(M,this).code_open}set code_open(e){E(M,this).code_open=e}get overview_open(){return E(M,this).overview_open}set overview_open(e){E(M,this).overview_open=e}get probability_open(){return E(M,this).probability_open}set probability_open(e){E(M,this).probability_open=e}get settings_open(){return E(M,this).settings_open}set settings_open(e){E(M,this).settings_open=e}get selected_dmg(){return E(M,this).selected_dmg}set selected_dmg(e){E(M,this).selected_dmg=e}get selected(){return[...E(M,this).selected]}get hasSelected(){return Boolean(E(M,this).selected.size)}isSelected(e){return E(M,this).selected.has(e)}toggleSelected(e){E(M,this).selected.has(e)?E(M,this).selected.delete(e):E(M,this).selected.add(e),E(M,this).selected=E(M,this).selected}constructor(...e){super(...e),C(this,M,new T),S(this,"debug_code",z,this),S(this,"debug_open",$,this),window.addEventListener("popstate",this.restore),(0,r.registerDestructor)(this,(()=>window.removeEventListener("popstate",this.restore))),this.restore()}async store(){let e=0n
for(const o of E(M,this).selected.values()){const[t,r]=o.split(",").map((e=>parseInt(e)))
e|=1n<<BigInt(t+9*r)}const t=[],r=[1,(0,l.compress)((0,a.default)(this.code),t),t,[E(M,this).code_open,E(M,this).overview_open,E(M,this).probability_open,E(M,this).settings_open].map((e=>e?1:0)).join(""),E(M,this).selected_dmg??-1,e.toString(2).split("").reverse().join(""),[E(M,this).my_deck_trg,E(M,this).my_deck_ds,E(M,this).my_unused_trg,E(M,this).my_unused_ds,E(M,this).op_unused_cx,E(M,this).op_unused_ds].map((e=>e??null)).join(",")],n=`?${await async function(e){e=JSON.stringify(e)
const t=[await I(new Blob(["",await new Response(new Blob([e]).stream().pipeThrough(new CompressionStream("deflate-raw"))).blob()]))]
return t.reduce(((e,t)=>e.length<t.length?e:t))}(r)}`
new URLSearchParams(`?=${n.slice(1)}`).get("")!==new URLSearchParams(`?=${location.search.slice(1)}`).get("")&&window.history.pushState("","",n)}async restore(){try{const t=new URLSearchParams(`?=${location.search?.slice?.(1)??""}`).get("")
if(!t?.length)return
try{const[e,r,n,o,i,c,d]=await async function(e){const t=await async function(e){return new Blob([A(e,s.default)])}(e).then((e=>e.arrayBuffer())),r=new Int8Array(t,0,1)[0],n=new Blob([new Int8Array(t,1)])
let o
switch(r){case 0:o=await n.json()
break
case 1:o=await new Response(n.stream().pipeThrough(new DecompressionStream("deflate-raw"))).json()
break
case 2:o=await new Response(n.stream().pipeThrough(new DecompressionStream("gzip"))).json()
break
default:throw new Error("marker?")}return o}(t)
if(1!=e)return alert("incompatible state"),void window.history.pushState("","","?")
if(E(M,this).code=(0,a.unparse)((0,l.decompress)(r,n)),E(M,this).code_open="1"===o[0],E(M,this).overview_open="1"===o[1],E(M,this).probability_open="1"===o[2],E(M,this).settings_open="1"===o[3],E(M,this).selected_dmg=-1==i?null:i,E(M,this).selected=new Set(c.split("").map(((e,t)=>"1"===e&&[t%9,Math.floor(t/9)].join(","))).filter((e=>e))),d){const e=d.split(",").map((e=>""==e?null:e))
E(M,this).my_deck_trg=e[0],E(M,this).my_deck_ds=e[1],E(M,this).my_unused_trg=e[2],E(M,this).my_unused_ds=e[3],E(M,this).op_unused_cx=e[4],E(M,this).op_unused_ds=e[5]}}catch(e){return console.error(e),alert("error loading state"),void window.history.pushState("","","?")}}finally{E(M,this).loaded||(E(M,this).loaded=!0)}}},z=D(P.prototype,"debug_code",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=D(P.prototype,"debug_open",[n.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),D(P.prototype,"store",[o.action],Object.getOwnPropertyDescriptor(P.prototype,"store"),P.prototype),D(P.prototype,"restore",[o.action],Object.getOwnPropertyDescriptor(P.prototype,"restore"),P.prototype),P)
async function I(e){return function(e,t){if(!(e instanceof Uint8Array))throw new Error("Must be Uint8Array")
const r=BigInt(t.length)
let n=e.reduce(((e,t)=>e<<8n|BigInt(t)),0n),o=""
for(;0n!==n;)o+=t[n%r],n/=r
return o}(new Uint8Array(await e.arrayBuffer()),s.default)}function A(e,t){const r=BigInt(t.length)
let n=0n
for(;e.length;){n*=r
const o=t.indexOf(e.at(-1))
if(o<0)throw new Error("letter not found in codes")
n+=BigInt(o),e=e.slice(0,-1)}let o=[]
for(;0n!==n;)o.push(Number(0xFFn&n)),n>>=8n
return new Uint8Array(o.reverse())}})),define("ws/templates/application",["exports","@ember/template-factory"],(function(e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"ymsZvKdT",block:'[[[1,[28,[35,0],["Weiß Schwarz Probability Calculator"],null]],[1,"\\n"],[8,[39,1],null,null,null],[1,"\\n"],[8,[39,2],null,null,null],[1,"\\n"],[1,"\\n"],[46,[28,[37,4],null,null],null,null,null],[1,"\\n"]],[],false,["page-title","data-highlighter","shell","component","-outlet"]]',moduleName:"ws/templates/application.hbs",isStrictMode:!1})})),define("ws/utils/code-compressor",["exports","ws/utils/code-parser"],(function(e,t){function r(e,t){t??=null
const n=e.short??(t?`!${e.indent}`:"")
!e.short&&t&&t.push(e.text)
e.code?.length&&(e.code.length>2?e.code.slice(1).join(","):e.code.slice(1).join())
const o=e.short&&t?";":""
if(!e.children.length)return`${n}${o}`
return`${n}{${e.children.map((e=>r(e,t))).join("")}}`}function n(e){let t=e
if("("==e[0]){const r=e.indexOf(")")
t=e.slice(r+1),e=e.slice(1,r)}else{const r=e.split("").findIndex((e=>";"===e||"{"===e))
t=e.slice(r+(";"===e[r])),e=e.slice(0,r)}return[e.split(",").map((e=>{switch(e){case"cx":return"cx"
case"ncx":return"not cx"
case"trg":return"trg"
case"ntrg":return"not trg"
case"cxtrg":return"cx and trg"
case"ncxtrg":return"not cx and trg"
case"cxntrg":return"cx and not trg"
case"ncxntrg":return"not cx and not trg"}const t=parseInt(e)
return isNaN(t)?e:t})),t]}function o(e,t,r){let n=e
if("{"!==e[0])return[[],n]
let o=0,s=0
for(const i of e){if("{"===i)s+=1
else if("}"===i&&(s-=1,0===s))break
o+=1}return e=e.slice(1,o),n=n.slice(o+1),[i(e,t,r),n]}function i(e,r,i=0){const s=[]
for(;e.length;){const a=e[0]
let l=[],c=[]
if(e=e.slice(1),"!"!==a&&([l,e]=n(e)),[c,e]=o(e,r,i+2),"!"===a){const t=/^([0-9]*)/.exec(e)[0]
e=e.slice(t.length),s.push({text:r.shift().trimEnd(),children:c,indent:t.length?parseInt(t):i})}else{const e=t.syntax.find((e=>e.short===a&&e.params.length==l.length))??t.syntax.find((e=>e.short===a)),r=[e.name,...l]
s.push({short:a,code:r,text:e.to_text?.(...l)??r.join(" ").trimEnd(),children:c,indent:i})}}return s}Object.defineProperty(e,"__esModule",{value:!0}),e.compress=function(e,t){return e.map((e=>r(e,t))).filter((e=>e)).join("")},e.decompress=i})),define("ws/utils/code-execute",["exports"],(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=async function*(e,t){const r=Math.max(1,(navigator.hardwareConcurrency??2)-1),n=Array(r).fill(null).map((()=>{const e=new Worker("./worker/worker-d4f938cba024374d7eea88c26d7851a4.js",{type:"module"})
return e.promise=null,e}))
try{const r=e.toReversed()
let o=0
for(;o||r.length;){let e
if(t.throwIfAborted(),r.length){if(e=n.find((e=>!e.promise)),!e){const t=n.map(((e,t)=>e.promise.then((()=>t))))
e=n[await Promise.race(t)]}}else e=n.find((e=>e.promise)),e||(e=n[0])
const i=await e.promise
if(i){if(o-=1,"outofmemory"in i&&(r.push(i.data),n.length>1)){e.terminate(),n.splice(n.indexOf(e),1)
continue}yield i}if(r.length){const t=new MessageChannel
e.promise=new Promise((e=>t.port1.onmessage=({data:t})=>e(t))),e.postMessage(r.pop(),[t.port2]),o+=1}else e.promise=null}}catch(o){if(o instanceof DOMException&&"AbortError"===o.name)return
throw o}finally{n.forEach((e=>e.terminate()))}}})),define("ws/utils/code-parser",["exports"],(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){e??=""
const r=/^(.*)$/gm,n=[]
for(;;){const t=r.exec(e)
if(!t)break
t.index===r.lastIndex&&r.lastIndex++,n.push({text:t[1],lineoffset:t.index})}const o=new Set,i=[],s=[],a={children:[]},l=[a]
for(let{text:d,lineoffset:u}of n){let e=0,r=0
for(let t=0;t<d.length&&/\s/.exec(d[t]);++t)if(r+=1,"\t"===d[t])e+=2
else e+=1
d=d.slice(r)
let n=l.at(-1)
for(;n&&n.indent>=e;)l.pop(),n=l.at(-1)
let a=null
for(const p of t){p.regex.lastIndex=0
const t=p.regex.exec(d)
if(t){const m={short:p.short,text:d,indent:e,code:[p.name,t.slice(1).map(((e,t)=>p.params[t]?p.params[t](e):e))],children:[],offset:u+r}
if(p.toplevel&&0!=e){a="needs to be toplevel, zero indent"
break}if(p.unique_name){const[e]=m.code[1]
if(o.has(e)){a=`name ${e} already in use`
break}o.add(e)}if(p.check_unique_name&&i.push(m),p.disallow_children&&s.push(m),m.code.length>2?m.short=`${m.short}(${m.code.slice(1).join(",")})`:m.short=`${m.short}${m.code.slice(1).join(",")}`,p.need_parent){if(!l.find((e=>["attack","burn","mill","reveal"].includes(e?.code?.[0])))){a="needs a 'attack'/'burn'/'mill' or 'reveal' as parent"
break}}else if(p.need_prev_sibling){var c=!1
for(let e=n.children.length-1;e>=0;--e)if("code"in n.children[e]){if(p.need_prev_sibling.includes(n.children[e].code[0])){c=n.children[e]
break}break}if(!c){a=`needs a ${p.need_prev_sibling.join(",")} as previous sibling`
break}m.code[1]=c.code[1]}l.push(m),n.children.push(m)
break}}if(n===l.at(-1)){const t={text:d,indent:e,error:a,children:[],offset:u+r}
n.children.push(t)}}for(const t of i){const[e]=t.code[1]
o.has(e)||(t.error=`there is no function with the name ${e}`)}for(const t of s)t.children?.length&&(t.error="no children allowed")
return a.children},e.syntax=void 0,e.unparse=function e(t){return t.map((t=>t.children.length?[`${" ".repeat(t.indent)}${t.text}`,e(t.children)].join("\n"):`${" ".repeat(t.indent)}${t.text}`)).join("\n")}
const t=e.syntax=[{regex:/^attack\s+([0-9]+)\s*$/g,params:[parseInt],name:"attack",short:"a"},{regex:/^attack\s+(cx)\s*$/g,params:[()=>"cx"],name:"attack",short:"a",need_parent:!0},{regex:/^attack\s+(not\s+cx)\s*$/g,params:[()=>"ncx"],name:"attack",short:"a",need_parent:!0},{regex:/^attack\s+(trg)\s*$/g,params:[()=>"trg"],name:"attack",short:"a",need_parent:!0},{regex:/^attack\s+(not\s+trg)\s*$/g,params:[()=>"ntrg"],name:"attack",short:"a",need_parent:!0},{regex:/^burn\s+([0-9]+)\s*$/g,params:[parseInt],name:"burn",short:"b"},{regex:/^burn\s+(cx)\s*$/g,params:[()=>"cx"],name:"burn",short:"b",need_parent:!0},{regex:/^burn\s+(not\s+cx)\s*$/g,params:[()=>"ncx"],name:"burn",short:"b",need_parent:!0},{regex:/^burn\s+(trg)\s*$/g,params:[()=>"trg"],name:"burn",short:"b",need_parent:!0},{regex:/^burn\s+(not\s+trg)\s*$/g,params:[()=>"ntrg"],name:"burn",short:"b",need_parent:!0},{regex:/^mill\s+([0-9]+)\s*$/g,params:[parseInt],name:"mill",short:"m"},{regex:/^mill\s+(cx)\s*$/g,params:[()=>"cx"],name:"mill",short:"m",need_parent:!0},{regex:/^mill\s+(not\s+cx)\s*$/g,params:[()=>"ncx"],name:"mill",short:"m",need_parent:!0},{regex:/^mill\s+(trg)\s*$/g,params:[()=>"trg"],name:"mill",short:"m",need_parent:!0},{regex:/^mill\s+(not\s+trg)\s*$/g,params:[()=>"ntrg"],name:"mill",short:"m",need_parent:!0},{regex:/^damage\s+([0-9]+)\s*$/g,params:[parseInt],name:"damage",short:"d"},{regex:/^damage\s+(cx)\s*$/g,params:[()=>"cx"],name:"damage",short:"d",need_parent:!0},{regex:/^damage\s+(not cx)\s*$/g,params:[()=>"ncx"],name:"damage",short:"d",need_parent:!0},{regex:/^damage\s+(trg)\s*$/g,params:[()=>"trg"],name:"damage",short:"d",need_parent:!0},{regex:/^damage\s+(not trg)\s*$/g,params:[()=>"ntrg"],name:"damage",short:"d",need_parent:!0},{regex:/^repeat\s+([0-9]+)\s*$/g,params:[parseInt],name:"repeat",short:"r"},{regex:/^each\s+(cx)\s*$/g,params:[()=>"cx"],name:"each",short:"e",need_parent:!0},{regex:/^each\s+(not\s+cx)\s*$/g,params:[()=>"ncx"],name:"each",short:"e",need_parent:!0},{regex:/^each\s+(trg)\s*$/g,params:[()=>"trg"],name:"each",short:"e",need_parent:!0},{regex:/^each\s+(not\s+trg)\s*$/g,params:[()=>"ntrg"],name:"each",short:"e",need_parent:!0},{regex:/^if\s+(cx)\s*$/g,params:[()=>"cx"],name:"if",short:"i",need_parent:!0},{regex:/^if\s+(not\s+cx)\s*$/g,params:[()=>"ncx"],name:"if",short:"i",need_parent:!0},{regex:/^if\s+(trg)\s*$/g,params:[()=>"trg"],name:"if",short:"i",need_parent:!0},{regex:/^if\s+(not\s+trg)\s*$/g,params:[()=>"ntrg"],name:"if",short:"i",need_parent:!0},{regex:/^if\s+(not\s+cx)\s*$/g,params:[()=>"ncx"],name:"if",short:"i",need_parent:!0},{regex:/^if\s+(trg)\s*$/g,params:[()=>"trg"],name:"if",short:"i",need_parent:!0},{regex:/^if\s+(not\s+trg)\s*$/g,params:[()=>"ntrg"],name:"if",short:"i",need_parent:!0},{regex:/^if\s+(cx)\s*and trg\s*$/g,params:[()=>"cxtrg"],name:"if",short:"i",need_parent:!0},{regex:/^if\s+(trg)\s*and cx\s*$/g,params:[()=>"cxtrg"],name:"if",short:"i",need_parent:!0},{regex:/^if\s+(not cx)\s*and trg\s*$/g,params:[()=>"ncxtrg"],name:"if",short:"i",need_parent:!0},{regex:/^if\s+(trg)\s*and not cx\s*$/g,params:[()=>"ncxtrg"],name:"if",short:"i",need_parent:!0},{regex:/^if\s+(cx)\s*and not trg\s*$/g,params:[()=>"cxntrg"],name:"if",short:"i",need_parent:!0},{regex:/^if\s+(not trg)\s*and cx\s*$/g,params:[()=>"cxntrg"],name:"if",short:"i",need_parent:!0},{regex:/^if\s+(not cx)\s*and not trg\s*$/g,params:[()=>"ncxntrg"],name:"if",short:"i",need_parent:!0},{regex:/^if\s+(not trg)\s*and not cx\s*$/g,params:[()=>"ncxntrg"],name:"if",short:"i",need_parent:!0},{regex:/^else\s*$/g,params:[],name:"else",short:"j",need_prev_sibling:["if","each"]},{regex:/^(reveal)\s*$/g,params:[()=>1],name:"reveal",short:"p"},{regex:/^reveal\s+remove\s+(cx)\s*$/g,params:[()=>1,()=>1],name:"reveal",short:"p",to_text:(e,t)=>t?`reveal ${e??1} remove cx`:`reveal ${e??1}`},{regex:/^reveal\s+([0-9]+)\s*$/g,params:[parseInt],name:"reveal",short:"p"},{regex:/^reveal\s+([0-9]+)\s+remove\s+(cx)\s*$/g,params:[parseInt,()=>1],name:"reveal",short:"p",to_text:(e,t)=>t?`reveal ${e??1} remove cx`:`reveal ${e??1}`},{regex:/^procedure\s*([a-zA-Z_]+[a-zA-Z0-9_]*)\s*/g,params:[e=>e],name:"procedure",short:"f",toplevel:!0,unique_name:!0},{regex:/^execute\s*([a-zA-Z_]+[a-zA-Z0-9_]*)\s*/g,params:[e=>e],name:"execute",short:"c",check_unique_name:!0,disallow_children:!0},{regex:/^reshuffle\s*/g,params:[],name:"reshuffle",short:"s"}]})),define("ws/utils/result-map",["exports","@ember/object","@glimmer/tracking"],(function(e,t,r){var n,o,i,s,a,l
function c(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function d(e,t){return e.get(p(e,t))}function u(e,t,r){return e.set(p(e,t),r),r}function p(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r
throw new TypeError("Private element is not present on this object")}function m(e,t,r,n,o){var i={}
return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer?(Object.defineProperty(e,t,i),null):i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let f=(o=m((n=class{constructor(){var e,t,r,n
e=this,t="value",n=this,(r=o)&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}}).prototype,"value",[r.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n)
e.default=(s=new WeakMap,a=new WeakMap,l=new WeakMap,m((i=class{constructor(e,t){c(this,s,void 0),c(this,a,void 0),c(this,l,void 0),u(s,this,e),u(a,this,t),u(l,this,Array(e*t).fill(null).map((()=>new f)))}clear(){d(l,this).forEach(((e,t,r)=>r[t].value=void 0))}get(e,t){return d(l,this)[e+t*d(s,this)]?.value}set(e,t,r){d(l,this)[e+t*d(s,this)].value=r}}).prototype,"get",[t.action],Object.getOwnPropertyDescriptor(i.prototype,"get"),i.prototype),m(i.prototype,"set",[t.action],Object.getOwnPropertyDescriptor(i.prototype,"set"),i.prototype),i)})),define("ws/utils/tiptap/fix-copy",["exports","@tiptap/core","@tiptap/pm/state"],(function(e,t,r){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=t.Extension.create({name:"fix-copy",addOptions:()=>({}),addProseMirrorPlugins:()=>[new r.Plugin({key:new r.PluginKey("fix-copy"),props:{clipboardSerializer:{serializeFragment(e,t){const r=new DocumentFragment,n=document.createElement("pre"),o=e.textBetween(0,e.size,"\n"),i=t.document.createElement("span"),s=o.split("\n").map((e=>(i.innerText=e,i.innerHTML))).join("<br>")
return i.innerHTML=s,n.append(i),r.append(n),r}},clipboardTextSerializer:(e,t)=>e.content.textBetween(0,e.content.size,"\n"),transformPastedHTML(e){const t=document.createElement("span")
t.innerHTML=e
for(const n of t.querySelectorAll("br"))n.replaceWith(document.createTextNode("\n"))
const r=document.createElement("div")
for(const n of t.innerText.split("\n")){const e=document.createElement("p")
e.append(document.createTextNode(n)),r.append(e)}return`<div data-pm-slice="0 0 []">${r.innerHTML}</div>`}}})]})})),define("ws/utils/tiptap/ide-enter",["exports","@tiptap/core"],(function(e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=t.Extension.create({name:"ide-enter",addOptions:()=>({}),addKeyboardShortcuts:()=>({Enter:({editor:e})=>{const{state:t}=e,{selection:r}=t,{$from:n}=r,o=n.node(1)?.textContent,i=o?.match(/^\s*/)?.[0]
return!!e.commands.splitBlock()&&(i&&e.commands.insertContent(i),!0)}})})})),define("ws/utils/tiptap/ide-tab",["exports","@tiptap/core"],(function(e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=t.Extension.create({name:"ide-tab",addOptions:()=>({}),addKeyboardShortcuts:()=>({Tab:({editor:e})=>{const{nodes:t,pos_start:n,pos_end:o}=r(e)
if(!t?.length)return e.chain().insertContent("  ").run(),!0
t.reverse()
let i=n,s=o
const a=e.chain()
for(const{text:r,pos:l}of t){const c=r.match(/^ */)[0].length
if(1==t.length&&r.slice(c)!==e.state.doc.textBetween(n,o))return e.chain().insertContent("  ").run(),!0
const d=2*Math.floor(c/2+1)-c,u=" ".repeat(d)
l<=n&&(i+=d),l<=o&&(s+=d),a.insertContentAt(l,u)}return a.setTextSelection({from:i,to:s}),a.run(),!0},"Shift-Tab":({editor:e})=>{const{nodes:t,pos_start:n,pos_end:o}=r(e)
if(!t.length)return!0
t.reverse()
let i=n,s=o
const a=e.chain()
for(const{text:r,pos:l}of t){const e=r.match(/^ */)[0].length,t=Math.max(0,2*Math.floor(e/2-1))-e
l<=n&&(i+=t),l<=o&&(s+=t),a.deleteRange({from:l,to:l-t})}return a.setTextSelection({from:i,to:s}),a.run(),!0}})})
function r(e){const{$from:t,$to:r}=e.state.selection
let n=t.pos,o=r.pos
const i=[]
return e.state.doc.nodesBetween(n,o,((e,t)=>{"text"===e.type.name&&i.push({text:e.text,pos:t})})),!i.length||(n=Math.max(n,i.at(0).pos),o=Math.min(o,i.at(-1).pos+i.at(-1).text.length),{nodes:i,pos_start:n,pos_end:o})}})),define("ws/utils/tiptap/linter-plugin",["exports"],(function(e){function t(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e
var r=e[Symbol.toPrimitive]
if(void 0!==r){var n=r.call(e,t||"default")
if("object"!=typeof n)return n
throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string")
return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=class{constructor(e){t(this,"doc",void 0),t(this,"results",[]),this.doc=e}record(e,t,r,n){this.results.push({cls:e,from:t,to:r,fix:n})}scan(){return this}getResults(){return this.results}}}))
define("ws/utils/tiptap/linter-ws-code",["exports","ws/utils/tiptap/linter-plugin","ws/utils/code-parser"],(function(e,t,r){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends t.default{scan(){const e=[]
this.doc.descendants(((t,r)=>{t.isText&&e.push({text:t.text,position:r})}))
let t="",n=[]
for(const{text:r,position:o}of e)n.push([t.length,o]),t+=r+"\n"
const i=o((0,r.default)(t))
for(const r of i){if(!r.error&&!r.code)continue
const e=n.findLast((e=>e[0]<=r.offset))
if(!e)break
const t=e[1]+r.offset-e[0]
let o=r.text.indexOf(" ");-1==o&&(o=r.text.length)
const i=t+o,s=t+r.text.length
r.error&&this.record("lint-code-error",t,s),this.record("lint-code-ok lint-code-ok2",t,i),this.record("lint-code-ok",i,s)}return this}}function*o(e){for(const t of e)if(yield t,Array.isArray(t?.children))for(const e of o(t?.children))yield e}e.default=n})),define("ws/utils/tiptap/linter",["exports","@tiptap/core","@tiptap/pm/state","@tiptap/pm/view"],(function(e,t,r,n){function o(e,t){const r=[]
return t.map((t=>new t(e).scan().getResults())).flat().forEach((e=>{r.push(n.Decoration.inline(e.from,e.to,{class:e.cls}))})),n.DecorationSet.create(e,r)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=t.Extension.create({name:"linter",addOptions:()=>({plugins:[]}),addProseMirrorPlugins(){const{plugins:e}=this.options
return[new r.Plugin({key:new r.PluginKey("linter"),state:{init:(t,{doc:r})=>o(r,e),apply:(t,r)=>t.docChanged?o(t.doc,e):r},props:{decorations(e){return this.getState(e)}}})]}})})),define("ws/config/environment",[],(function(){try{var e="ws/config/environment",t=document.querySelector('meta[name="'+e+'"]').getAttribute("content"),r={default:JSON.parse(decodeURIComponent(t))}
return Object.defineProperty(r,"__esModule",{value:!0}),r}catch(n){throw new Error('Could not read config from meta tag with name "'+e+'".')}})),runningTests||require("ws/app").default.create({name:"ws",version:"0.0.0"})
